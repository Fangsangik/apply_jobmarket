{% extends "base.html" %}

{% block content %}
<!-- 히어로 섹션 -->
<div class="hero-section">
    <div class="container">
        <div class="text-center">
            <h1 class="hero-title">🎯 IT 채용시장 분석</h1>
            <p class="hero-subtitle">실시간 채용공고 데이터로 스마트한 취업 전략을 세우세요</p>
        </div>
    </div>
</div>

<div class="container mb-5">
    <div class="d-flex gap-3 align-items-start">
        <!-- 분석 설정 (33.333% 너비) -->
        <div style="flex: 0 0 33.333%;">
            <div class="card analysis-section">
                <div class="card-header bg-primary text-white">
                    <h5><i class="fas fa-filter me-2"></i>분석 설정</h5>
                </div>
                <div class="card-body">
                    <form id="analyze-form" action="/analyze" method="POST">
                        <!-- 직무 선택 -->
                        <div class="mb-3">
                            <label class="form-label">직무</label>
                            <select name="job_role" class="form-select">
                                <option value="전체">전체</option>
                                <option value="백엔드">백엔드 개발자</option>
                                <option value="프론트엔드">프론트엔드 개발자</option>
                                <option value="AI/머신러닝">AI/머신러닝</option>
                                <option value="DevOps">DevOps 엔지니어</option>
                                <option value="기획">기획/PM</option>
                                <option value="디자인">디자인</option>
                                <option value="데이터분석">데이터 분석</option>
                                <option value="QA">QA/테스터</option>
                            </select>
                        </div>

                        <!-- 경력 선택 -->
                        <div class="mb-3">
                            <label class="form-label">경력</label>
                            <select name="experience" class="form-select">
                                <option value="전체">전체</option>
                                <option value="신입">신입</option>
                                <option value="1-2년">1-2년</option>
                                <option value="3-5년">3-5년</option>
                                <option value="6-8년">6-8년</option>
                                <option value="9년 이상">9년 이상</option>
                            </select>
                        </div>

                        <!-- 연봉 범위 -->
                        <div class="mb-3">
                            <label class="form-label">연봉 범위 (만원)</label>
                            <div class="row">
                                <div class="col-6">
                                    <input type="number" name="min_salary" class="form-control" placeholder="최소" min="0" max="15000" step="500">
                                </div>
                                <div class="col-6">
                                    <input type="number" name="max_salary" class="form-control" placeholder="최대" min="0" max="15000" step="500">
                                </div>
                            </div>
                        </div>

                        <!-- 회사 유형 -->
                        <div class="mb-3">
                            <label class="form-label">회사 유형</label>
                            <select name="company_type" class="form-select">
                                <option value="전체">전체</option>
                                <option value="국내기업">국내기업</option>
                                <option value="외국계">외국계</option>
                            </select>
                        </div>

                        <button type="submit" class="btn btn-analyze w-100">
                            <i class="fas fa-rocket me-2"></i>분석 시작
                        </button>
                    </form>

                    <!-- 로딩 스피너 -->
                    <div class="loading-spinner text-center">
                        <div class="spinner-border text-primary me-3" role="status"></div>
                        <span>분석 중...</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 플랫폼 소개 (66.667% 너비) -->
        <div style="flex: 0 0 66.667%;">
            <div class="card platform-intro">
                <div class="card-header bg-info text-white">
                    <h5><i class="fas fa-info-circle me-2"></i>실시간 채용 데이터 분석</h5>
                </div>
                <div class="card-body">
                    <h6>🚀 IT 채용시장 분석 플랫폼</h6>
                    <p class="text-muted">실시간 채용공고 데이터를 수집하여 IT 취업 트렌드를 분석하는 전문 도구입니다.</p>
                    
                    <!-- 통계 카드들 -->
                    <div class="row mb-4">
                        <div class="col-md-4 mb-3">
                            <div class="stats-card">
                                <span class="stats-number">197K+</span>
                                <div class="stats-label">총 채용공고</div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="stats-card">
                                <span class="stats-number">50+</span>
                                <div class="stats-label">직무 분류</div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="stats-card">
                                <span class="stats-number">1000+</span>
                                <div class="stats-label">기업 정보</div>
                            </div>
                        </div>
                    </div>
                    
                    <h6 class="mt-4">📋 핵심 기능</h6>
                    <ul>
                        <li><strong>🔍 실시간 데이터 수집</strong>: PostgreSQL 기반 19만+ 채용공고 실시간 분석</li>
                        <li><strong>🎯 고도화된 필터링</strong>: 직무/경력/연봉/회사유형별 세밀한 조건 설정</li>
                        <li><strong>🏢 스마트 기업 분류</strong>: AI 기반 국내/외국 기업 자동 분류</li>
                        <li><strong>📄 최적화된 페이지네이션</strong>: DB 레벨 쿼리 최적화로 빠른 페이지 이동</li>
                        <li><strong>📊 실시간 시각화</strong>: 5가지 차트로 채용시장 트렌드 분석</li>
                    </ul>
                    
                    <h6 class="mt-4">🎯 분석 가능한 직무</h6>
                    <div class="row">
                        <div class="col-6">
                            <ul class="list-unstyled">
                                <li><i class="fas fa-code text-primary me-2"></i>백엔드/프론트엔드</li>
                                <li><i class="fas fa-mobile-alt text-success me-2"></i>모바일 개발</li>
                                <li><i class="fas fa-robot text-info me-2"></i>AI/머신러닝</li>
                            </ul>
                        </div>
                        <div class="col-6">
                            <ul class="list-unstyled">
                                <li><i class="fas fa-cloud text-warning me-2"></i>DevOps/클라우드</li>
                                <li><i class="fas fa-chart-bar text-danger me-2"></i>데이터 엔지니어링</li>
                                <li><i class="fas fa-cogs text-secondary me-2"></i>시스템 엔지니어</li>
                            </ul>
                        </div>
                    </div>
                    
                    <h6 class="mt-4">📝 사용 가이드</h6>
                    <ol>
                        <li><strong>조건 설정</strong>: 관심 직무, 경력, 연봉 범위 선택</li>
                        <li><strong>회사 필터</strong>: 국내/외국 기업 선택</li>
                        <li><strong>분석 실행</strong>: "분석 시작" 버튼으로 실시간 데이터 조회</li>
                        <li><strong>결과 탐색</strong>: 페이지네이션으로 모든 채용공고 확인</li>
                        <li><strong>시각화 분석</strong>: 5가지 차트로 시장 트렌드 파악</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('analyze-form');
    const loadingSpinner = document.querySelector('.loading-spinner');
    
    form.addEventListener('submit', function(e) {
        e.preventDefault();
        
        // 로딩 표시
        loadingSpinner.style.display = 'block';
        
        // FormData 생성
        const formData = new FormData(form);
        
        // fetch API 사용
        fetch('/analyze', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            loadingSpinner.style.display = 'none';
            
            if (data.success) {
                window.location.href = data.redirect;
            } else {
                alert('분석 실패: ' + (data.error || '알 수 없는 오류'));
            }
        })
        .catch(error => {
            loadingSpinner.style.display = 'none';
            alert('오류 발생: ' + error.message);
        });
    });
});
</script>
{% endblock %}